---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# regMR

<!-- badges: start -->

[![R-CMD-check](https://github.com/vjoshy/regMR/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/vjoshy/regMR/actions/workflows/R-CMD-check.yaml) [![Codecov test coverage](https://codecov.io/gh/vjoshy/regMR/graph/badge.svg)](https://app.codecov.io/gh/vjoshy/regMR)

<!-- badges: end -->

## Overview

## Installation

You can install the development version of regMR from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
library(devtools)
install_github("vjoshy/regMR")
```

## Key Functions

The regMR package includes the following functions for use:

### `FGMRM()`

Fits Regularized Finite Gaussian Mixture Regression Model Using MM Algorithm over range of lambda-alpha pairs and group counts. 

### `MM_Grid_FGMRM()`

Fits Regularized Finite Gaussian Mixture Regression Model Using MM Algorithm over range of lambda-alpha pairs.

### `MM_FGMRM()`

Fits Regularized Finite Gaussian Mixture Regression Model Using MM Algorithm.

### `summary()`

S3 method for summarizing results from the `FGMRM()` and `MM_Grid_FGMRM()` functions of class FGMRM. Outputs the number of mixture components, optimal lambda-alpha, log-likelihood, bic, mean-squared-error, and parameters (pi, sigma, beta) of the model.

### `plot()`

S3 method for plotting results from the `FGMRM()` and `MM_Grid_FGMRM()` functions of class FGMRM. Outputs three plots:

1.  Lambdas vs. the BICs of models with the same alpha as the optimal alpha.
2.  Regression parameters over lambdas for all models with the same alpha as the optimal alpha.
3.  Group norms over lambdas for all models with the same alpha as the optimal alpha.

### `plot2()`

Plots a specified covariate of the predictor/design matrix (x) against the response vector (y). The observations are coloured per the group responsibility matrix (z_hard) in the finite Gaussian mixture regression model of class FGMRM passed to the function. 

## Example

This is a basic example which shows you how to use all aspects of the regMR package:

```{r example, echo = FALSE}
# ----Load the regMR package----
library(regMR)

# install.packages("mvtnorm")

set.seed(2025)

# ----Simulate data----
n <- 500   # total samples
p <- 3     # number of covariates
G <- 3     # number of mixture components
rho = 0.2  # correlation

# ----True parameters for 3 clusters----
betas <- matrix(c(
  1,  2, -1,  0.5,   # Component 1
  5, -2,  1,  1.5,   # Component 2
  -3, 0,  2, -1      # Component 3
), nrow = G, byrow = TRUE)
pis <- c(0.4, 0.4, 0.2)
sigmas <- c(3, 1.5, 1)

# ----Generate correlation matrix----
cor_mat <- outer(1:p, 1:p, function(i, j) rho^abs(i - j))
Sigma <- cor_mat

# ----Simulate design matrix X (n Ã— p)----
X <- mvtnorm::rmvnorm(n, mean = rep(0, p), sigma = Sigma)

# ----Generate responsibilities----
z <- rmultinom(n, size = 1, prob = pis)
groups <- apply(z, 2, which.max)

# ----b0 + b1x1 + b2x2 + ... + bkxp----
mu_vec <- rowSums(cbind(1, X) * betas[groups, ])

# ----Simulate response y----
y <- rnorm(n, mean = mu_vec, sd = sigmas[groups])

mod <- FGMRM(x = X, y = y, G = 6)

plot(mod)

plot2(mod, X, y, 1)
plot2(mod, X, y, 2)
plot2(mod, X, y, 3)

summary(mod)
```

What is special about using `README.Rmd` instead of just `README.md`? You can include R chunks like so:

```{r cars}
summary(cars)
```

You'll still need to render `README.Rmd` regularly, to keep `README.md` up-to-date. `devtools::build_readme()` is handy for this.

You can also embed plots, for example:

```{r pressure, echo = FALSE}
plot(pressure)
```

In that case, don't forget to commit and push the resulting figure files, so they display on GitHub and CRAN.
